# Idle Mech RPG - Project Report

**Generated by:** Cyrus (OpenClaw)
**Date:** January 31, 2026

## 1. Project Overview
**Idle Mech RPG** is a hybrid application combining a performant C++ backend game engine with a web-based frontend interface. The game is an idle/incremental RPG where players pilot a mech, fight through floors of enemies, defeat bosses, and upgrade their equipment.

## 2. Technical Architecture

### Backend (Game Engine & Server)
*   **Language:** C++17
*   **Web Framework:** [Crow](https://github.com/CrowCpp/Crow) (Microframework for Web/APIs).
*   **Build System:** CMake (Handles compilation and asset injection).
*   **Data Serialization:** `nlohmann/json`.
*   **Concurrency:**
    *   The Web Server runs on a separate thread (Crow multithreading).
    *   The Game Logic runs on its own dedicated thread (`Game::gameLoop`).
    *   State is synchronized using mutexes (`game_state_mutex`) to ensure thread-safe data access between the game loop and API requests.

### Frontend (User Interface)
*   **Tech:** HTML5, CSS3, Vanilla JavaScript.
*   **Communication:** Polling mechanism.
    *   The frontend fetches `/api/gamestate` every 500ms to sync the UI.
    *   Actions (Start Game, Equip) are sent via `POST` requests.
*   **Rendering:** DOM manipulation (updating text, progress bars, lists).

## 3. Game Logic Breakdown

### Core Systems
*   **Game Loop:** A tick-based system that handles combat phases (`IDLE`, `PLAYER_TURN`, `ENEMY_TURN`, etc.).
*   **Stats System:**
    *   Primary stats: Health, Armor, Energy Shield, Attack, Speed, etc.
    *   Stats are derived from **Base Stats** (Mech Chassis) + **Equipment** (Items).
*   **Equipment Slots:**
    *   Armor: HEAD, CHEST, ARMS, LEGS.
    *   Core: GENERATOR.
    *   Weapons: LEFT/RIGHT ARM, LEFT/RIGHT SHOULDER.

### Progression
*   **Floors & Waves:** Players advance through floors.
*   **Enemies:** Standard enemies spawn sequentially.
*   **Bosses:** Every 20 enemies (configurable), a Boss spawns with higher stats.
*   **Loot:** Enemies drop items which are stored in the inventory and can be equipped.

## 4. Project Structure
```text
/
├── CMakeLists.txt       # Build configuration
├── data/                # JSON data (items.json, bosses.json)
├── src/                 # C++ Source Code
│   ├── main.cpp         # Entry point, Web Server setup
│   ├── Game.cpp/.h      # Core game loop & state management
│   ├── Mech.cpp/.h      # Player/Enemy entity logic
│   ├── Item.cpp/.h      # Item data structures
│   └── ...              # Helper classes (Stats, Equipment)
└── web/                 # Frontend Assets
    ├── index.html       # Main Game Dashboard
    ├── style.css        # Styling
    └── script.js        # Frontend logic & API calls
```

## 5. Current State Observations
*   **Alpha Stage:** The core loop (Fight -> Loot -> Equip -> Progress) appears functional.
*   **Data Driven:** Heavy reliance on JSON for items and bosses makes balancing and adding content easy.
*   **Deployment:** The project is set up to run locally (`localhost:18080`).
*   **Visuals:** Basic text/bar UI with some floating combat text logic implemented in JS.

## 6. Recommendations / Next Steps
*   **Event Driven Updates:** Replace polling with WebSockets (if supported by Crow) or Server-Sent Events (SSE) for smoother UI updates and lower overhead.
*   **Persistence:** Implement a save/load system (writing `GameState` to a file) to persist progress across restarts.
*   **Combat Depth:** Implement specific weapon types (Lasers vs Missiles) or active abilities.
*   **Frontend Polish:** Move to a component-based framework (React/Vue) if the UI complexity grows, though vanilla JS is fine for now.
